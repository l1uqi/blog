---
title: 前端曝光实现
top_img: false
date: 2022-11-08
categories:
  - 前端
tags:
  - 埋点
---

## 什么是曝光?

商品曝光人数：看到商品在首页、列表页、活动页面，以及在商品详情页下方的更多展现的人数。（不包括商品详情页的访客数量）
商品曝光次数：商品在店铺首页、列表页、活动页面，以及在商品详情页下方的更多展现的次数。（不包括商品详情页的浏览量）

> 通过商品曝光我们能得出商品在不同营销位的比重， 从而得出用户操作喜好

## 实现

曝光肯定是结合埋点一起使用， 通过采集某个商品是否出现在用户的可视区域内, 进行上报。

### 判断是否在用户可视区域内

#### 1. getBoundingClientRect()

getBoundingClientRect 方法返回一个 对象，该 DOMRect 对象提供有关元素大小及其相对于视口的位置的信息。

![](https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect/element-box-diagram.png)

```js
const isElementInViewport = (el) => {
  let rect = el.getBoundingClientRect();
  return (
    rect.top >= 0 &&
    rect.left >= 0 &&
    rect.bottom <=
      (window.innerHeight || document.documentElement.clientHeight) &&
    rect.right <= (window.innerWidth || document.documentElement.clientWidth)
  );
};
```
